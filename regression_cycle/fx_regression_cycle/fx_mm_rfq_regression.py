# from test_cases.fx.fx_mm_rfq.QAP_T2976 import QAP_T2976
from test_cases.fx.fx_mm_rfq import QAP_T2845, QAP_T2843, QAP_T2678, QAP_T2629, \
     QAP_T2931, QAP_T2863, QAP_T2846, QAP_T2844, QAP_T2819, QAP_T2818, QAP_T2817, QAP_T2816, QAP_T2815, \
    QAP_T2814, QAP_T2740, QAP_T2732, QAP_T2731, QAP_T2721, QAP_2992, QAP_T2715, QAP_T2714, QAP_T2539, QAP_4748
from test_cases.fx.fx_mm_rfq.QAP_T2443 import QAP_T2443
from test_cases.fx.fx_mm_rfq.QAP_T2463 import QAP_T2463
from test_cases.fx.fx_mm_rfq.QAP_T2466 import QAP_T2466
from test_cases.fx.fx_mm_rfq.QAP_T2480 import QAP_T2480
from test_cases.fx.fx_mm_rfq.QAP_T2481 import QAP_T2481
from test_cases.fx.fx_mm_rfq.QAP_T2528 import QAP_T2528
from test_cases.fx.fx_mm_rfq.QAP_T2538 import QAP_T2538
from test_cases.fx.fx_mm_rfq.QAP_T2614 import QAP_T2614
from test_cases.fx.fx_mm_rfq.QAP_T2646 import QAP_T2646
from test_cases.fx.fx_mm_rfq.QAP_T2716 import QAP_T2716
from test_cases.fx.fx_mm_rfq.QAP_T2739 import QAP_T2739
from test_cases.fx.fx_mm_rfq.QAP_T2741 import QAP_T2741
from test_cases.fx.fx_mm_rfq.QAP_T2861 import QAP_T2861
from test_cases.fx.fx_mm_rfq.QAP_T2869 import QAP_T2869
from test_cases.fx.fx_mm_rfq.QAP_T2880 import QAP_T2880
from test_cases.fx.fx_mm_rfq.QAP_T2885 import QAP_T2885
from test_cases.fx.fx_mm_rfq.QAP_T2886 import QAP_T2886
from test_cases.fx.fx_mm_rfq.QAP_T2887 import QAP_T2887
from test_cases.fx.fx_mm_rfq.QAP_T2888 import QAP_T2888
from test_cases.fx.fx_mm_rfq.QAP_T2906 import QAP_T2906
from test_cases.fx.fx_mm_rfq.QAP_T2910 import QAP_T2910
from test_cases.fx.fx_mm_rfq.QAP_T2929 import QAP_T2929
from test_cases.fx.fx_mm_rfq.QAP_T2930 import QAP_T2930
from test_cases.fx.fx_mm_rfq.QAP_T2940 import QAP_T2940
from test_cases.fx.fx_mm_rfq.QAP_T2962 import QAP_T2962
from test_cases.fx.fx_mm_rfq.QAP_T2969 import QAP_T2969
from test_cases.fx.fx_mm_rfq.QAP_T2979 import QAP_T2979
from test_cases.fx.fx_mm_rfq.QAP_T2978 import QAP_T2978
from test_cases.fx.fx_mm_rfq.QAP_T2977 import QAP_T2977
from test_cases.fx.fx_mm_rfq.QAP_T2974 import QAP_T2974
from test_cases.fx.fx_mm_rfq.QAP_T7967 import QAP_T7967
from test_cases.fx.fx_mm_rfq.QAP_T7981 import QAP_T7981
from test_cases.fx.fx_mm_rfq.QAP_T2970 import QAP_T2970
from test_cases.fx.fx_mm_rfq.QAP_T2963 import QAP_T2963
from test_cases.fx.fx_mm_rfq.QAP_T2905 import QAP_T2905
from test_cases.fx.fx_mm_rfq.QAP_T2879 import QAP_T2879
from test_cases.fx.fx_mm_rfq.QAP_T2878 import QAP_T2878
from test_cases.fx.fx_mm_rfq.QAP_T2877 import QAP_T2877
from test_cases.fx.fx_mm_rfq.QAP_T2836 import QAP_T2836
from test_cases.fx.fx_mm_rfq.QAP_T2834 import QAP_T2834
from test_cases.fx.fx_mm_rfq.QAP_T2828 import QAP_T2828
from test_cases.fx.fx_mm_rfq.QAP_T2976 import QAP_T2976
from test_cases.fx.fx_mm_rfq.QAP_T2973 import QAP_T2973
from test_cases.fx.fx_mm_rfq.QAP_T2972 import QAP_T2972
from test_cases.fx.fx_mm_rfq.QAP_T2820 import QAP_T2820
from test_cases.fx.fx_mm_rfq.QAP_T2780 import QAP_T2780
from test_cases.fx.fx_mm_rfq.QAP_T2694 import QAP_T2694
from test_cases.fx.fx_mm_rfq.QAP_T2692 import QAP_T2692
from test_cases.fx.fx_mm_rfq.QAP_T2691 import QAP_T2691
from test_cases.fx.fx_mm_rfq.QAP_T2690 import QAP_T2690
from test_cases.fx.fx_mm_rfq.QAP_T2689 import QAP_T2689
from test_cases.fx.fx_mm_rfq.QAP_3112 import QAP_3112
from test_cases.fx.fx_mm_rfq.QAP_T2688 import QAP_T2688
from test_cases.fx.fx_mm_rfq.QAP_T2677 import QAP_T2677
from test_cases.fx.fx_mm_rfq.QAP_T2600 import QAP_T2600
from test_cases.fx.fx_mm_rfq.QAP_T2546 import QAP_T2546
from test_cases.fx.fx_mm_rfq.QAP_T2527 import QAP_T2527
from test_cases.fx.fx_mm_rfq.QAP_T2519 import QAP_T2519
from test_cases.fx.fx_mm_rfq.QAP_T8011 import QAP_T8011
from test_cases.fx.fx_mm_rfq.QAP_T2500 import QAP_T2500
from test_cases.fx.fx_mm_rfq.QAP_T2410 import QAP_T2410
from test_cases.fx.fx_mm_rfq.QAP_T2389 import QAP_T2389
from test_cases.fx.fx_mm_rfq.QAP_T2385 import QAP_T2385
from test_cases.fx.fx_mm_rfq.QAP_T2376 import QAP_T2376
from test_cases.fx.fx_mm_rfq.QAP_T2939 import QAP_T2939
from test_cases.fx.fx_mm_rfq.QAP_T8020 import QAP_T8020
from test_cases.fx.fx_mm_rfq.QAP_T8030 import QAP_T8030
from test_cases.fx.fx_mm_rfq.QAP_T8031 import QAP_T8031
from test_cases.fx.fx_mm_rfq.QAP_T8168 import QAP_T8168
from test_cases.fx.fx_mm_rfq.QAP_T8195 import QAP_T8195
from test_cases.fx.fx_mm_rfq.QAP_T8409 import QAP_T8409
from test_cases.fx.fx_mm_rfq.QAP_T8419 import QAP_T8419
from test_cases.fx.fx_mm_rfq.interpolation import QAP_T2589
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2444 import QAP_T2444
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2461 import QAP_T2461
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2583 import QAP_T2583
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2603 import QAP_T2603
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2596 import QAP_T2596
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2594 import QAP_T2594
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2580 import QAP_T2580
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2579 import QAP_T2579
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2575 import QAP_T2575
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2574 import QAP_T2574
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2573 import QAP_T2573
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2572 import QAP_T2572
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2560 import QAP_T2560
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2559 import QAP_T2559
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2558 import QAP_T2558
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2475 import QAP_T2475
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2448 import QAP_T2448
from test_cases.fx.fx_mm_rfq.QAP_T2420 import QAP_T2420
from test_cases.fx.fx_mm_rfq.QAP_T2419 import QAP_T2419
from test_cases.fx.fx_mm_rfq.QAP_T2418 import QAP_T2418
from test_cases.fx.fx_mm_rfq.QAP_T2417 import QAP_T2417

from test_cases.fx.fx_mm_rfq.QAP_T2454 import QAP_T2454
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2584 import QAP_T2584
from test_cases.fx.fx_mm_rfq.interpolation.QAP_T2537 import QAP_T2537
from test_cases.fx.fx_mm_rfq.manual_intervention.QAP_T2549 import QAP_T2549
from test_cases.fx.fx_mm_rfq.manual_intervention.QAP_T2550 import QAP_T2550
from test_cases.fx.fx_mm_rfq.manual_intervention.QAP_T2597 import QAP_T2597
from test_cases.fx.fx_mm_rfq.manual_intervention.QAP_T2592 import QAP_T2592
from test_cases.fx.fx_mm_rfq.manual_intervention.QAP_T2442 import QAP_T2442
from test_cases.fx.fx_mm_rfq.rejection.QAP_T2581 import QAP_T2581
from test_cases.fx.fx_mm_rfq.rejection.QAP_T2598 import QAP_T2598
from test_cases.fx.fx_mm_rfq.rejection.QAP_T2595 import QAP_T2595
from test_cases.fx.fx_mm_rfq.update_quod_settings import update_settings_and_restart_qs

from stubs import Stubs
import logging
from custom import basic_custom_actions as bca
from test_framework.configurations.component_configuration import ComponentConfiguration
from test_framework.data_sets.fx_data_set.fx_data_set import FxDataSet
from win_gui_modules.utils import set_session_id, prepare_fe_2, get_opened_fe

logging.basicConfig(format='%(asctime)s - %(message)s')
logger = logging.getLogger(__name__)
logger.setLevel(logging.INFO)
timeouts = False
channels = dict()


def test_run(parent_id=None, version=None):
    configuration = ComponentConfiguration("RFQ_MM")
    report_id = bca.create_event(f"FX_MM_RFQ" if version is None else f"FX_MM_ESP | {version}", parent_id)
    session_id = set_session_id(target_server_win="ostronov")
    Stubs.custom_config['qf_trading_fe_main_win_name'] = "Quod Financial - Quod site 314"
    try:

        case_params = {
            'case_id': bca.create_event_id(),
            'TraderConnectivity': 'fix-ss-rfq-314-luna-standard',
            'Account': 'Iridium1',
            'SenderCompID': 'QUODFX_UAT',
            'TargetCompID': 'QUOD9',
        }
        # if not Stubs.frontend_is_open:
        #     prepare_fe_2(report_id, session_id)
        # else:
        #     get_opened_fe(report_id, session_id)

        # region Rejection
        update_settings_and_restart_qs("Rejection")
        QAP_T2581(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2598(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2595(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2834(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        # endregion

        # region Manual Intervention
        update_settings_and_restart_qs("Manual Intervention")
        QAP_T2442(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2549(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2550(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2592(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2597(report_id, session_id, configuration.data_set, configuration.environment).execute()
        # endregion

        # region Interpolation
        update_settings_and_restart_qs("Interpolation")
        QAP_T2444(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2448(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2461(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2475(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2537(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2558(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2559(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2560(session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2572(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2573(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2574(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2575(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2579(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2580(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2583(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2584(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2589.execute(report_id)
        QAP_T2594(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2596(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2603(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        # endregion

        QAP_T2962(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2939(report_id=report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2886(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2879(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2861(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2845.execute(report_id)
        QAP_T2843.execute(report_id)
        QAP_T2836(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2834(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2828(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2716(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2678.execute(report_id)
        QAP_T2629.execute(report_id)
        QAP_T2614(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2546(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2538(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T8195(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2527(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2500(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T8011(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()

        QAP_T2979(report_id=report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2978(report_id, session_id, configuration.data_set, configuration.environment).execute()

        QAP_T2977(report_id=report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2976(report_id=report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2969(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2940(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2929(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2888(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2887(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2481(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()

        QAP_T2974(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2973(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2972(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T7981(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2970(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2963(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()

        QAP_T2931.execute(report_id, case_params, session_id)
        QAP_T2930(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2905(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2869(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2910(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2906(report_id, session_id, configuration.data_set, configuration.environment).execute()

        QAP_T2885(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2880(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2878(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2877(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()

        QAP_T2863.execute(report_id, session_id)
        QAP_T2846.execute(report_id, session_id)
        QAP_T2844.execute(report_id, session_id)
        QAP_T2820(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2819.execute(report_id, session_id)
        QAP_T2818.execute(report_id, session_id)
        QAP_T2817.execute(report_id, session_id)
        QAP_T2816.execute(report_id, session_id)
        QAP_T2815.execute(report_id, session_id)
        QAP_T2814.execute(report_id, session_id)
        QAP_T2780(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2741(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2740.execute(report_id, session_id)
        QAP_T2739(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2732.execute(report_id, session_id)
        QAP_T2731.execute(report_id, session_id)
        QAP_T2721.execute(report_id, session_id)
        QAP_2992.execute(report_id, session_id)
        QAP_T2715.execute(report_id, session_id)
        QAP_T2714.execute(report_id, session_id)
        QAP_T2694(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2600(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2692(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2691(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2690(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2689(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_3112(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2688(report_id, session_id, configuration.data_set, configuration.environment).execute()

        QAP_T2677(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2646(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2539.execute(report_id, session_id)
        QAP_T2519(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_4748.execute(report_id, session_id)
        QAP_T2454(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2443(session_id, configuration.data_set, configuration.environment).execute()

        QAP_T2454(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2420(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2419(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2418(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2417(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2410(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2389(report_id, session_id, configuration.data_set, configuration.environment).execute()
        QAP_T2385(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2376(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2463(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2466(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2480(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T2528(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T8168(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T8409(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T8419(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T7967(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()


        # region Deposit and Loan
        QAP_T8020(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T8030(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        QAP_T8031(report_id, data_set=configuration.data_set, environment=configuration.environment).execute()
        # endregion

    except Exception:
        logging.error("Error execution", exc_info=True)
    finally:
        # close_fe(report_id, session_id)
        pass


if __name__ == '__main__':
    test_run()
    Stubs.factory.close()
